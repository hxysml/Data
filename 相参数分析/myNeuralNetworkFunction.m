function [Y,Xf,Af] = myNeuralNetworkFunction(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Auto-generated by MATLAB, 12-Sep-2023 21:45:21.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = Qx12 matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = Qx1 matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [0.279595827039163;0.0867076923076923;1.61538461538462;0;-76.44;1.65045573317758;1.1657;0;25.765;0.484122918275927;437.535;0.551956405201859];
x1_step1.gain = [0.0605469648797198;20.8211997670356;0.196969696969696;0.369863360727655;0.0231642344220524;0.120356717552134;1.51941046873813;4.00249121426347;0.00726043023634097;0.0144813358040795;0.000699024104098669;0.0267621020307195];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.7378813740058935977;-1.8814309603715941854;-1.829437278590100302;-1.4721258057208601588;1.3994665654802049826;-1.2655245244419999207;1.1147732954112681281;1.198753503194653236;-0.69490846828583829886;0.31338373422239973465;0.65762932330175249973;0.53518812848313879194;0.20913738137145179707;-0.018789215771104483821;-0.11880579699742230271;0.39585422679415099845;-0.24755590990016484998;0.6149071075593784963;0.48214366819532289421;-0.60615297843594528882;0.43848728334586595246;0.8795014364999583778;-1.0659378325034893908;-1.1553459926436049354;1.2259054841197256636;1.500755120118163477;-1.3842795095278861428;-1.4718621676333565329;-1.7323548002963782277;2.1209991560680236944];
IW1_1 = [0.040438113844469450453 0.18140353535144523867 -0.27386574811079694713 -1.1047390030949935102 -0.26818926185745017854 0.78071485163192888557 -0.14064383970260679879 0.41439547861619097091 1.0413700678914667996 0.21210529817161499766 -0.06927711740344751068 -0.69150890473725123986;0.43229926027875709149 0.20156853030428348306 -0.42245710723822127441 -0.61497635342400325253 -0.34211916489030408384 -0.5355683647616386045 0.82243727215159290189 -0.20988292675402803189 -0.0023434600810165757273 -0.66496868505728523591 -0.76616834028721236827 0.12191355739195608443;0.30258901613819022547 -0.73147631583130678923 -0.49575137579448325109 0.15789145647617719437 -0.11771420853531681938 -0.60263730973133811109 0.41393988060875358537 -0.32418013105418813646 -0.50958361163661780591 0.87081276996583345529 -0.10164355978453291918 -0.50316248670906404961;0.95155013783133879368 -0.03015502393347360352 -0.95742818805326357356 -0.34140672213927769629 0.31407777685629567621 -0.29502068440396705951 0.4588149065573041141 0.59966902270318256374 0.74737762689559728013 0.14365340911715498984 0.42052427345862952723 -0.10097790522657545953;-0.39128696631134213257 -0.61450047686947173453 0.80681922586010601517 -0.44409573828497295178 0.22255957542074689126 -0.7284659508851486498 0.21575496614699105069 -0.64018712660826637695 0.73662714872272616606 0.1009135502759088282 -0.16535922620025575447 0.52394119128076688252;0.14886462116872209438 0.36923144978659722115 0.95829714628327555825 -0.76512485515811234915 -0.44630133663603044347 0.16439851215648390581 -0.94241763245844112351 -0.55714334479360660968 -0.11918327632612070455 0.27846745570080133625 0.38611479724864983254 -0.052651873823296592436;-0.65303465059787391134 0.36159554002192306754 0.41290304524067134029 -0.98755926756790957111 0.1749401358535979667 0.5407946947473369903 0.38759213208482767854 0.013242937351161662013 0.43137585540285183772 0.099225947182880330777 -0.085054267723126339429 0.71483051973424815984;-0.31644896216737450345 -0.62281996230580316531 0.24521759702796391833 0.43121707835903011485 0.52790306652697904788 -0.55125847896299096096 -0.36581990088869154043 -0.033684007533461020334 -0.79017350329253199792 -0.72123323566590735734 0.68001354373455757951 0.21153265797633866163;0.019498815011114157408 0.49173486034382613008 0.094242958947426555549 -0.31156860210636522224 -0.66487532439046048705 -0.80096427565197270138 -0.81642141067320883607 0.51728813786409966191 -0.55169377636503968976 -0.97060246697894136947 -0.37441268263728338939 0.011618822542974280992;0.023569488233773874808 0.71973420546258937147 0.60369133751781467456 0.15807387703785871769 -1.044118481358404571 -1.0019828032778275162 -0.79918160251325587318 0.16685792891429157558 -0.85926633631668858371 -0.2980296904766071564 -0.78466547380161832947 0.032678519901196814712;-0.15199351201399910472 -0.35504843399015817429 -0.97722246667648482443 -0.15498724097987437442 -1.4696922259098068597 -0.70919004524715822946 0.44158335363919293259 0.76915840697937509773 -0.74986851415782951324 -0.29364123949228121413 0.98164353459242414957 -0.21570008359969700118;-0.32274695396217872867 0.62159267492088920992 -1.1751930849456053707 -0.18779170423483057539 1.0077456451974466933 -0.17008419866368096329 -0.53152965760999848488 -0.49400873859315397318 -0.41037043125853889247 0.33589735205492443626 0.0094580052723772303769 0.74764456200670414976;-0.38392351896227749908 0.21058682426721808678 0.37714139597481516342 0.4407346666507809263 0.24430679142243891255 0.059943102230547495868 -0.10647550653597104287 1.1216631013104712 -0.35831403300854564042 1.2737491310092516894 0.14245859146587708244 0.24752134498658073802;0.50575308995284073976 -0.25361275177091507915 -0.22497186457218515399 1.0103902167191307626 -0.61351806371666461892 -0.58113336813385663149 -0.24045218324147832334 -0.36698582688602587876 -0.78922429814083561173 -0.67160736208222682198 -0.29962953889425114617 -1.010766400870150461;0.22104942254510867583 -0.092148009076908635184 -0.90058304246259768266 -0.8193239895452695265 -0.38232521725188395312 0.31223732613299703953 -0.14013511823166463488 0.59882924521160318942 0.52494360294812969503 0.35650260205358941246 -0.71771296551295815647 1.0462930397059309051;-0.61898453308097378667 0.46097663332437377459 0.69523474393631390367 0.69617306930098854512 0.80956138641948982571 -0.60786327677146823056 -0.56728888631429841283 -0.9649773627005113763 0.070648633052242906794 0.21799606808716065487 -0.49070363964845320481 -0.38039457015312228005;0.057425404072075254824 -0.71142073482316869892 -0.35378511197852641201 0.0028753541387542642591 0.30309030384084367782 -0.76018944328637927388 0.49589334743685853368 1.1600930015760431147 0.91984874734613508718 0.20021151778689919021 0.090648147237045020863 0.19925883801347291091;0.54943609934886994406 -0.004014963188337610997 0.88136623360843990849 -0.2951011335921078782 -0.86275344733880821035 0.26303943212718849942 -0.73609274617879294489 0.22864731454673989375 0.1650337668620912579 0.53526358914530247635 0.73880612989481675434 0.13320952801235935725;0.4101421967007908842 0.3471210176326289254 -0.91518314061643812884 0.036794031947578874353 0.88686580636021372648 -0.27620116590060628248 0.41114436180241997754 -0.58655339617853630152 0.58441348772485501861 0.23492097489100272067 -1.1007984415488882846 0.3880602170568665521;-0.92733472679862560817 0.79427702899089536182 -0.72064917443872789082 -0.4240955104084110916 0.19117153700410333128 0.064800027728233233759 -0.36838193604339952714 0.72866475662044183359 0.50524309990415339211 0.078478891882027349003 0.15390156947744357274 0.4644473360940239437;0.08220251692841297475 -0.44221449205518831294 0.79045006570071862928 -1.0247414696298644543 0.6147839433670908571 -0.41590619727895949964 0.9602827232838346827 0.63348662883477591112 0.71685103625997326215 -0.80883458917614015071 -0.77355809074350823096 -0.1961803704326657849;0.37769149749617092482 -0.39234417439417279549 0.49083720919547796369 -0.55395166051333621926 0.41642318712059489538 -0.91314356752672198869 0.21508521430102925387 -0.47216431624919447119 0.38287997092024356194 -0.89730891514614097293 -0.66559776438033269041 0.003372161153880335379;-0.19598552981840644538 0.29816639241501913249 -0.59239051740721926365 0.25475253092795285825 -0.88838696320967314168 -0.28739733371936904138 -0.48913075245808973479 0.3895354277163584622 -0.46594409748137616267 1.0085116281612378497 0.47433481630905549586 -0.25538348289587486928;-0.37378771130656618382 0.9091191762270971477 0.022340092333177581641 0.73447133247475715478 -0.23450982076068097038 0.13939568035872981766 -0.66690977266325413009 0.19967729663358380066 -0.66201885570023266681 0.68652071530134028965 -0.38529450153398120404 0.63211990579892429754;0.079491637771960041436 0.63600475283600832466 -0.61737566118202713561 0.54483712169454134866 0.69697481201411393137 -0.5689881979148155855 -0.28769380728822202542 -0.44348047202542134615 0.28178064016438308936 0.59115467209370486934 -0.58321134367903160189 0.70094488315168479442;0.75389365891487136739 0.0098343414551081646119 0.20766757645374347985 0.19568372799193534117 -0.26545670046720093449 0.30258304036855415697 0.7625011853540805129 0.04985235691063637925 0.70707507276541348151 1.0236525889058829542 0.24190185028120145261 -0.61465173863710331759;-0.76067060712394396482 0.079507109295776673408 0.18484642458587255409 -0.047447233049189047049 -0.14709430647491780753 0.78880814595033299508 -0.4912452444744931368 0.75677537152511198393 -0.64367337937349777821 0.41161680664139771446 -0.59127175534688192204 0.82136906478356519479;-0.23072394715146168909 0.72419707922860376836 0.39551227880142159066 0.22840123006445300913 0.30226119702065162853 -1.2692322692848008181 0.78049153114716462998 0.015948809483813792404 -0.80547871684440197626 -0.088847705410967800499 -0.70594833252841238114 0.33347391583996233155;0.013002460801151499714 0.6834729269986575817 0.61744999949178824838 0.42405109293978499041 0.90720292624068687992 -0.29890770676786704296 0.58154656816496796967 -0.70601741438988407928 -0.037037716126888338419 -0.28104675403251272447 -0.59761882183612102803 -0.55813906946600810866;0.59936831275328783519 0.94315201492723799159 0.58356986674724331543 -0.2391482768882467469 0.050971862108172345807 -0.008723037080594108969 0.062494107333243342772 0.29094597190482712756 0.35362123627582919827 -0.64630232169718937474 0.73798724023718464959 -0.16343196721704142393];

% Layer 2
b2 = -0.41116070536808724256;
LW2_1 = [-0.39873227042992287483 -0.066153675742089662615 0.42894039182287774237 -0.12868649040127130845 -0.095722791045769764495 0.6067344867793716956 -0.17129512310586850199 -0.57797204735445362189 0.27816493075770210019 1.1252628052018596172 1.4369398149307079926 -0.92781188705823858243 0.46659201272777117708 0.77241395962626258065 -1.0512439436224629841 0.98505724758495138982 -0.60389110618061325741 0.69839110792776859515 -0.84593338426753861281 -0.039607217880780754005 -1.5898572157727051124 -0.97187772782689640927 0.045908226504527104017 0.62372775640606459291 -0.3198269300387809877 0.83130746068888017319 -0.25438369597733501148 -0.86187606636921687553 -0.32862415627257235418 -0.59646142741459540204];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
    X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},1); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    X{1,ts} = X{1,ts}';
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = logsig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Output 1
    Y{1,ts} = a2;
    Y{1,ts} = Y{1,ts}';
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
    Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Positive Transfer Function
function a = logsig_apply(n,~)
a = 1 ./ (1 + exp(-n));
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end
